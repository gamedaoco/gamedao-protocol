specVersion: 0.0.5
schema:
  file: ./schema.graphql
dataSources:
  # GameDAO Registry - Central module management
  - kind: ethereum
    name: GameDAORegistry
    network: localhost
    source:
      address: "0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0"
      abi: GameDAORegistry
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - Module
        - ModuleRegistration
        - ModuleUpgrade
      abis:
        - name: GameDAORegistry
          file: ./abis/GameDAORegistry.json
      eventHandlers:
        - event: ModuleRegistered(indexed bytes32,indexed address,string)
          handler: handleModuleRegistered
        - event: ModuleEnabled(indexed bytes32)
          handler: handleModuleEnabled
        - event: ModuleDisabled(indexed bytes32)
          handler: handleModuleDisabled
        - event: ModuleUpgraded(indexed bytes32,indexed address,indexed address,string)
          handler: handleModuleUpgraded
      file: ./src/registry.ts

  # Control Module - DAO Management
  - kind: ethereum
    name: Control
    network: localhost
    source:
      address: "0xCf7Ed3AccA5a467e9e704C703E8D87F634fB0Fc9"
      abi: Control
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - Organization
        - Member
        - Treasury
        - Stake
      abis:
        - name: Control
          file: ./abis/Control.json
        - name: Treasury
          file: ./abis/Treasury.json
      eventHandlers:
        - event: OrganizationCreated(indexed bytes32,indexed address,indexed address,string,uint8,uint256)
          handler: handleOrganizationCreated
        - event: OrganizationUpdated(indexed bytes32,indexed address,uint8,uint8,uint32,uint256)
          handler: handleOrganizationUpdated
        - event: OrganizationStateChanged(indexed bytes32,uint8,uint8,uint256)
          handler: handleOrganizationStateChanged
        - event: MemberAdded(indexed bytes32,indexed address,uint8,uint256,uint256)
          handler: handleMemberAdded
        - event: MemberRemoved(indexed bytes32,indexed address,uint256)
          handler: handleMemberRemoved
        - event: MemberStateChanged(indexed bytes32,indexed address,uint8,uint8,uint256)
          handler: handleMemberStateChanged
        - event: MembershipFeeUpdated(indexed bytes32,uint256,uint256,uint256)
          handler: handleMembershipFeeUpdated
      file: ./src/control.ts

  # Flow Module - Crowdfunding & Campaigns
  - kind: ethereum
    name: Flow
    network: localhost
    source:
      address: "0xDc64a140Aa3E981100a9becA4E685f962f0cF6C9"
      abi: Flow
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - Campaign
        - Contribution
        - Reward
        - ProtocolFee
      abis:
        - name: Flow
          file: ./abis/Flow.json
      eventHandlers:
        - event: CampaignCreated(indexed bytes32,indexed bytes32,indexed address,string,uint8,uint256,uint256,uint256,uint256)
          handler: handleCampaignCreated
        - event: CampaignUpdated(indexed bytes32,string,string,uint256,uint256,uint256,uint256,uint256)
          handler: handleCampaignUpdated
        - event: CampaignStateChanged(indexed bytes32,uint8,uint8,uint256)
          handler: handleCampaignStateChanged
        - event: ContributionMade(indexed bytes32,indexed address,uint256,uint256,uint256)
          handler: handleContributionMade
        - event: CampaignFinalized(indexed bytes32,uint8,uint256,uint256,uint256)
          handler: handleCampaignFinalized
        - event: RewardsDistributed(indexed bytes32,indexed address,uint256,uint256,uint256)
          handler: handleRewardsDistributed
        - event: ContributionRefunded(indexed bytes32,indexed address,uint256,uint256)
          handler: handleContributionRefunded
        - event: ProtocolFeeCollected(indexed bytes32,indexed address,uint256,uint256)
          handler: handleProtocolFeeCollected
      file: ./src/flow.ts

  # Signal Module - Governance & Proposals
  - kind: ethereum
    name: Signal
    network: localhost
    source:
      address: "0x5FC8d32690cc91D4c39d9d3abcBD16989F875707"
      abi: Signal
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - Proposal
        - Vote
        - Delegation
      abis:
        - name: Signal
          file: ./abis/Signal.json
      eventHandlers:
        - event: ProposalCreated(indexed bytes32,indexed bytes32,indexed address,string,uint8,uint8,uint8,uint256,uint256,uint256)
          handler: handleProposalCreated
        - event: ProposalStateChanged(indexed bytes32,uint8,uint8,uint256)
          handler: handleProposalStateChanged
        - event: VoteCast(indexed bytes32,indexed address,uint8,uint256,string,uint256)
          handler: handleVoteCast
        - event: ProposalExecuted(indexed bytes32,bool,bytes,uint256)
          handler: handleProposalExecuted
        - event: ProposalCancelled(indexed bytes32,indexed address,uint256)
          handler: handleProposalCancelled
        - event: VotingPowerDelegated(indexed address,indexed address,uint256,uint256)
          handler: handleVotingPowerDelegated
        - event: VotingPowerUndelegated(indexed address,indexed address,uint256,uint256)
          handler: handleVotingPowerUndelegated
      file: ./src/signal.ts

  # GameStaking Contract - Staking & Rewards
  - kind: ethereum
    name: GameStaking
    network: localhost
    source:
      address: "0x0B306BF915C4d645ff596e518fAf3F9669b97016"
      abi: GameStaking
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - StakingPool
        - UserStake
        - UnstakeRequest
        - RewardClaim
        - RewardDistribution
        - SlashEvent
        - StakingPoolUpdate
        - StakingStats
      abis:
        - name: GameStaking
          file: ./abis/GameStaking.json
      eventHandlers:
        - event: Staked(indexed address,indexed uint8,uint256,uint8,uint256)
          handler: handleStaked
        - event: UnstakeRequested(indexed address,indexed uint8,uint256,uint8,uint256,uint256)
          handler: handleUnstakeRequested
        - event: Unstaked(indexed address,indexed uint8,uint256,uint256,uint256)
          handler: handleUnstaked
        - event: RewardsClaimed(indexed address,indexed uint8,uint256,uint256)
          handler: handleRewardsClaimed
        - event: RewardsDistributed(indexed uint8,uint256,uint256)
          handler: handleRewardsDistributed
        - event: Slashed(indexed address,indexed uint8,uint256,indexed address,string,uint256)
          handler: handleSlashed
        - event: PoolUpdated(indexed uint8,uint256,bool)
          handler: handlePoolUpdated
      file: ./src/staking.ts
